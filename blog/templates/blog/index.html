{% extends 'base.html' %}

{% block title %}Blog{% endblock %}

{% block extra_static %}
<link rel="stylesheet" href="{{ url_for('static', filename='index.css') }}">
<script src="{{ url_for('static', filename = 'like.js') }}" defer></script>
{% endblock %}

{% block content %}

{% if g.user %}
    <a href="{{ url_for('blog.create') }}">Novo</a>
{% endif %}

<section class="posts">

    {% for post in posts %}
    
        <article>
            <p>@{{ post.user.username }} | {{ post.created.strftime('%d/%m/%Y') }}</p>
            <h1>{{ post.title }}</h1>
            <p class="body">{{ post.body }}</p>
        
            <div class="actions">

                <div class="like-container">
                    <a class="like-button {% if g.user and deu_like(post.id, g.user.id) %}curtido{% endif %}" 
                    {% if not g.user %}
                        href="{{ url_for('auth.login') }}"
                    {% else %}
                        data-post-id="{{ post.id }}"
                    {% endif %}>
                        {{ post.like_count }} Curtir
                    </a>
                </div>
                
                {% if g.user.id == post.user.id %}
                    <a href="{{ url_for('blog.update', id=post.id) }}" class="edit-button">Editar</a>
                {% endif %}
            </div>
        </article>
    
        {% if not loop.last %}
            <hr>
        {% endif %}
        
    {% endfor %}

</section>

{% endblock %}